<!DOCTYPE html>
<html lang="en" data-accent-color="cyan" data-content_root="../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Data Link Control &amp; Flow Control - mahad@archives documentation</title><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Logical Addressing (IPv4)" href="logical_addressing.html" /><link rel="prev" title="Journal" href="../index.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"dark");
  </script><link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../../_static/shibuya.css?v=44020203" />
    <link media="print" rel="stylesheet" type="text/css" href="../../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=dc970a10" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="Data Link Control &amp; Flow Control"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../index.html">
      
      
      <strong>mahad@archives</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"><ul><li class="link"><a href="../../kernel/index.html">Kernel</a></li><li class="link"><a href="../../projects/index.html">Projects</a></li><li class="link"><a href="../../security/index.html">Security</a></li><li class="link"><a href="../index.html">Journal</a></li></ul></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials">
  <a href="https://github.com/Mahad-Ibrahim" aria-label="GitHub">
    <iconify-icon icon="simple-icons:github"></iconify-icon>
  </a></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Navigation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../kernel/index.html">Kernel Space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../kernel/Logs.html">Upstream Contributions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../projects/index.html">Engineering Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../projects/tartarus_gate/index.html">Project Tartarus: Advanced Windows Implant Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/mini_siem/index.html">Mini SIEM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security &amp; Malware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../security/evasion/index.html">Evasion Research</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../security/evasion/intro.html">EDR Evasion Intro</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../security/reversing/index.html">Reverse Engineering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../security/reversing/ghidra_setup.html">Ghidra Workflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Journal</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Link Control &amp; Flow Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="logical_addressing.html">Logical Addressing (IPv4)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#the-critical-problem-speed-mismatch">The Critical Problem: Speed Mismatch</a></li>
<li><a class="reference internal" href="#stop-and-wait-flow-control">Stop-and-Wait Flow Control</a></li>
<li><a class="reference internal" href="#sliding-window-flow-control-the-successor">Sliding Window Flow Control (The Successor)</a></li>
<li><a class="reference internal" href="#piggybacking-optimization">Piggybacking (Optimization)</a></li>
<li><a class="reference internal" href="#edge-cases">Edge Cases</a><ul>
<li><a class="reference internal" href="#case-a-no-new-data-to-send">Case A: No new data to send?</a></li>
<li><a class="reference internal" href="#case-b-data-to-send-but-no-new-ack">Case B: Data to send, but no new ACK?</a></li>
</ul>
</li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../index.html"><span itemprop="name">mahad@archives</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">Journal</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Data Link Control &amp; Flow Control</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <article class="yue" role="main">
          <section id="data-link-control-flow-control">
<h1>Data Link Control &amp; Flow Control<a class="headerlink" href="#data-link-control-flow-control" title="Link to this heading">¶</a></h1>
<section id="the-critical-problem-speed-mismatch">
<h2>The Critical Problem: Speed Mismatch<a class="headerlink" href="#the-critical-problem-speed-mismatch" title="Link to this heading">¶</a></h2>
<p><strong>The Problem</strong></p>
<p>If two machines have incompatible processing resources, and one machine overwhelms the other by constantly sending data, the receiving machine will have to drop frames because its buffer is already full. The frame essentially has nowhere to go.</p>
<p><strong>The Solution</strong></p>
<p>We need a mechanism that controls this flow/interchange of data so that neither machine can get overwhelmed. We can achieve this by relying on a simple idea: <strong>Feedback</strong>.</p>
</section>
<hr class="docutils" />
<section id="stop-and-wait-flow-control">
<h2>Stop-and-Wait Flow Control<a class="headerlink" href="#stop-and-wait-flow-control" title="Link to this heading">¶</a></h2>
<p>The simplest type of flow control. It basically just sends a packet to the receiver, the receiver says <em>“Hey I got it (ACK)”</em> back to the sender, and the sender only then sends the next packet.</p>
<p><strong>Pseudocode Logic</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
</span><span data-line="2"><span class="w">    </span><span class="n">send_frame</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span><span data-line="3"><span class="w">    </span><span class="n">wait_for_interrupt</span><span class="p">(</span><span class="n">ACK</span><span class="p">);</span><span class="w"> </span><span class="c1">// CPU Blocks here</span>
</span><span data-line="4"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>The Flaw</strong></p>
<p>The main flaw in Stop-and-Wait is that it is <strong>extremely inefficient</strong>. On very long distances, 99% of the wire is completely empty, as only 1 packet can be on the wire at any time. However, it is very robust and simple to implement.</p>
<hr class="docutils" />
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>ACK and SEQ Fields (The C Struct Reality)</p>
<p>In the most simple of forms, packets are <strong>C structs</strong>. The C struct cannot change layout just because you do not have an ACK to send. <strong>Both these fields MUST be filled.</strong></p>
<ul class="simple">
<li><p><strong>ACK (Acknowledgment Number):</strong> Represents <em>“I have received everything up to this number”</em>. It refers to the <strong>incoming</strong> data.</p></li>
<li><p><strong>SEQ (Sequence Number):</strong> Represents the ID of <strong>this specific packet</strong> being sent. It refers to the <strong>outgoing</strong> data.</p></li>
</ul>
<p><em>Key Takeaway:</em> SEQ and ACK are independent. SEQ identifies the packet itself. ACK confirms what has been received from the other side.</p>
</div>
</section>
<hr class="docutils" />
<section id="sliding-window-flow-control-the-successor">
<h2>Sliding Window Flow Control (The Successor)<a class="headerlink" href="#sliding-window-flow-control-the-successor" title="Link to this heading">¶</a></h2>
<p>This solves the inefficient “empty pipe” problem of Stop-and-Wait.</p>
<p><strong>How?</strong></p>
<p>It pushes multiple frames onto the wire <em>before</em> ever receiving the first ACK. As soon as it receives the first ACK, it ‘slides’ its window to the right to accommodate more.</p>
<p><strong>What if an ACK is missed?</strong></p>
<p>The window’s movement is strictly defined by the oldest unacknowledged frame. Meaning it <em>cannot</em> ‘slide’ forward until the oldest awk</p>
<ol class="arabic simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">ACK</span> <span class="pre">2</span></code> is lost, the sender’s window pointer for Frame 2 <strong>cannot move</strong>.</p></li>
<li><p>Even if <code class="docutils literal notranslate"><span class="pre">ACK</span> <span class="pre">3</span></code> arrives, the system assumes the sequential order is broken at 2.</p></li>
<li><p>The sender <strong>DOES NOT</strong> slide the window. It waits (and eventually times out) until <code class="docutils literal notranslate"><span class="pre">ACK</span> <span class="pre">2</span></code> is explicitly received. The window is effectively “stuck” at the missing frame.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dual Windows
In a full-duplex connection, there are <strong>2 windows</strong> in the network. One on the sender side and one on the receiver side. Both sides maintain their own personal sliding windows.</p>
</div>
</section>
<hr class="docutils" />
<section id="piggybacking-optimization">
<h2>Piggybacking (Optimization)<a class="headerlink" href="#piggybacking-optimization" title="Link to this heading">¶</a></h2>
<p><strong>The Problem</strong></p>
<p>In both Stop-and-Wait and Sliding Window, communication is bidirectional.
(Scenario: A sends Data → B sends ACK → B sends Data → A sends ACK).
Every “ACK” packet requires a full Ethernet/IP header (min 64 bytes) just to say “Yes.” This is a huge waste of bandwidth.</p>
<p><strong>The Concept</strong></p>
<p>Instead of sending a separate control frame just for ACK, we attach the ACK to the <strong>next outgoing data frame</strong>.</p>
<ul class="simple">
<li><p><strong>Implementation:</strong> The Frame Header has a specific field called <code class="docutils literal notranslate"><span class="pre">Ack</span> <span class="pre">Sequence</span> <span class="pre">Number</span></code>.</p></li>
<li><p><strong>Scenario:</strong> B receives a frame from A. When B builds its own data packet to send back, it sets <code class="docutils literal notranslate"><span class="pre">ACK</span> <span class="pre">=</span> <span class="pre">1</span></code> inside that header.</p></li>
</ul>
</section>
<section id="edge-cases">
<h2>Edge Cases<a class="headerlink" href="#edge-cases" title="Link to this heading">¶</a></h2>
<section id="case-a-no-new-data-to-send">
<h3>Case A: No new data to send?<a class="headerlink" href="#case-a-no-new-data-to-send" title="Link to this heading">¶</a></h3>
<p><strong>Problem:</strong> You (Station B) received a packet from A. A is running a retransmission timer. If you wait for your application to generate a “reply” payload to piggyback the ACK on, A’s timer might expire.</p>
<p><strong>Solution:</strong> You strip the payload and only send the header (Control Frame).</p>
<ul class="simple">
<li><p><strong>RR (Receive Ready):</strong> “I acknowledge all frames up to N. I am ready for N+1.” (Standard ACK).</p></li>
<li><p><strong>RNR (Receive Not Ready):</strong> “I acknowledge up to N, but <strong>STOP</strong>. My buffers are full.” (ACK + Flow Control Stop).</p></li>
</ul>
</section>
<section id="case-b-data-to-send-but-no-new-ack">
<h3>Case B: Data to send, but no new ACK?<a class="headerlink" href="#case-b-data-to-send-but-no-new-ack" title="Link to this heading">¶</a></h3>
<p><strong>Problem:</strong> You (Station B) are uploading a large file to A. A is just listening. You sent <code class="docutils literal notranslate"><span class="pre">ACK=5</span></code> in your previous packet. Now you need to send the next chunk of your file, but A has not sent any new data back to you.</p>
<p><strong>Constraint:</strong> The Header has a 32-bit field for Acknowledgment Number. It cannot be empty.</p>
<ul class="simple">
<li><p>You cannot put <code class="docutils literal notranslate"><span class="pre">6</span></code> (Because A has not sent Frame 6 yet).</p></li>
<li><p>You cannot put <code class="docutils literal notranslate"><span class="pre">0</span></code> (That looks like a reset).</p></li>
</ul>
<p><strong>Solution:</strong> <strong>You copy-paste the last valid ACK you sent (ACK=5).</strong></p>
<p>When A receives this, it sees <code class="docutils literal notranslate"><span class="pre">ACK=5</span></code> again. It compares it to its state (“I already received ACK 5”). It realizes this is a duplicate confirmation. It <strong>discards the ACK information</strong> (takes no action on the window) but <strong>accepts the Data payload</strong>. This ensures the protocol creates no false positives.</p>
</section>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="../index.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Journal</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="logical_addressing.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Logical Addressing (IPv4)</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2026, Mahad Ibrahim</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/Mahad-Ibrahim" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../_static/shibuya.js?v=cac61aee"></script>
      <script defer="defer" src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>
      <script defer="defer" src="../../_static/js/smooth_scroll.js?v=5f731fdf"></script></body>
</html>